%trainFcn = 'trainscg';

clearvars NNSave2 errorNN2 x2 zz2 errorEstSum2 errorEstIndex2 errorEstSumMaxIndex2 yy2 corrMat2 newY2 
%col norm avgMuR2mean avgMuR1mean avgMuR2std avgMuR1std rhoBShearMaxmean rhoBShearMaxstd rhoBPreShearMaxmean rhoBPreShearMaxstd startMinAvgMuR2Min startMinAvgMuR2Index startMinAvgMuR1Min startMinAvgMuR1Index ...
 %   startMinRhoPreMin startMinRhoPreIndex  startMinRhoPostMin startMinRhoPostIndex


dataNN2.rf = [0.07500,0.1250,0.1750,0.2250,0.2750,0.3250,0.3750,0.4250,0.4750,0.5250,0.5750,0.6250,0.6750,0.7250,0.7750,0.8250,0.8750,0.9250,0.9750];

dataNN2.sf = [0.2750,0.3250,0.3750,0.4250,0.4750,0.5250,0.5750,0.6250,0.6750];

dataNN2.rest = [0.500633013916978;0.504727402727026;0.505729863719947;0.509403323677638;0.532362393515512;0.535807461505731;0.543462480295657;0.549191033297432;0.564744561620868;0.596332229890282;0.605748568449736;0.606150883077090;0.607875859432593;0.620761920590896;0.627305391620438;0.632375414643735;0.643327024299222;0.650486788738718;0.654962940664485;0.656318884840031;0.663448958097712;0.665099422414058;0.669824021062721;0.670678237439267;0.676579424511317;0.679112813881188;0.681272139766144;0.725408428607214;0.732123316126128;0.747857687289951;0.755146166384765;0.757106876659697;0.772050835809346;0.775645095124385;0.787368439670147;0.788540803364255;0.811267351468337;0.811784667971925;0.812724427508269;0.814928540139214;0.816552594130803;0.819039921137523;0.832665187805884;0.840149871726020;0.849865084109196;0.854070331213916;0.860110800991694;0.875826113135389;0.883382010500446;0.883910263459658];

dataNN2.dCylDp = 30;

dataNN2.radsigma = [2.70828621627172e-05;3.44412707666563e-05;3.82745006735361e-05;4.58245942727159e-05;4.77335864829028e-05;4.92592774950189e-05;5.11264509728351e-05;5.34570536590604e-05;5.94041688254614e-05;6.41670894109490e-05;6.76168695268731e-05;6.89396751458054e-05;6.94993813200179e-05;6.96416452053721e-05;7.00639444716539e-05;7.33043884747512e-05;7.50218282935654e-05;8.39964627698043e-05;8.45675021665733e-05;8.62471590473415e-05;8.65404137360244e-05;9.15780232206874e-05;0.000107143362185186;0.000107825548557978;0.000112213709096875;0.000113542484041400;0.000117889571776570;0.000120762717743666;0.000121201631450949;0.000124368787126914;0.000124544140652634;0.000127421215951727;0.000127421856421461;0.000132807818325662;0.000139642150695422;0.000143947968449393;0.000147338426464920;0.000156471735378489;0.000156902591498737;0.000157510040094376;0.000161354265267852;0.000167499844562043;0.000170395009881851;0.000172125519797141;0.000180908069193765;0.000185508891170217;0.000187621134057765;0.000188451869740107;0.000192875999410953;0.000192955192740314];


dataNN2.ctrlStress = 5000;

dataNN2.radmu = 1e-3;

dataNN2.dens = 2500;

clearvars NNSave2 errorNN2 x2 zz2 errorEstSum2 errorEstIndex2 errorEstSumMaxIndex2 yy2 corrMat2 newY2

avgMuR2Pos = 9;
avgMuR1Pos = 10;
densityBulkBoxMeanPos = 11;
newY2 = myNewInputPolidispersity(bulkValue(9).NNSave2, bulkValue(9).errorEstSumMaxIndex2, dataNN2);
bulkValue(10).avgMuR2 = newY2(avgMuR2Pos,:);
bulkValue(10).avgMuR1 = newY2(avgMuR1Pos,:);
bulkValue(10).densityBulkBox = newY2(densityBulkBoxMeanPos,:);
bulkValue(10).name = 'holesFillingOne';

clearvars newY2

newY2 = myNewInputPolidispersity(bulkValue(6).NNSave2, bulkValue(6).errorEstSumMaxIndex2, dataNN2);
bulkValue(11).avgMuR2 = newY2(avgMuR2Pos,:);
bulkValue(11).avgMuR1 = newY2(avgMuR1Pos,:);
bulkValue(11).densityBulkBox = newY2(densityBulkBoxMeanPos,:);
bulkValue(11).name = 'holesFillingTwo';

clearvars newY2

newY2 = myNewInputPolidispersity(bulkValue(7).NNSave2, bulkValue(7).errorEstSumMaxIndex2, dataNN2);
bulkValue(12).avgMuR2 = newY2(avgMuR2Pos,:);
bulkValue(12).avgMuR1 = newY2(avgMuR1Pos,:);
bulkValue(12).densityBulkBox = newY2(densityBulkBoxMeanPos,:);
bulkValue(12).name = 'holesFillingThree';